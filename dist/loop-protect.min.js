/*! loop-protect | v0.9.0 | (c) 2014 Remy Sharp | http://jsbin.mit-license.org */
!function(a,b){"use strict";"function"==typeof define&&define.amd?define(b(a)):"object"==typeof exports?module.exports=b(a):a.loopProtect=b(a)}(this,function(a){"use strict";function b(a,b){if(0===a)return!1;var c=a,d=1,e=-1,f=-1;do if(c-=1,e=b[c].indexOf("*/"),f=b[c].indexOf("/*"),-1!==e&&d++,-1!==f&&(d--,0===d))return!0;while(0!==c);return!1}function c(a,b){for(var c;--a>-1;){if(c=b.substr(a,1),'"'===c||"'"===c||"."===c)return!0;if(("/"===c||"*"===c)&&(--a,"/"===c))return!0}return!1}function d(a,b,c){g.lastIndex=0,h.lastIndex=0;var d=!1,e=c.slice(b).join("\n").substr(a).replace(h,"");return e.replace(g,function(a,b,c){var f=e.substr(0,c).replace(i,"").trim();0===f.length&&(d=!0)}),d}var e=null,f=/\b(for|while|do)\b/g,g=/\b(for|while|do)\b/,h=/\b([a-z_]{1}\w+:)/i,i=/(?:\/\*(?:[\s\S]*?)\*\/)|(?:([\s;])+\/\/(?:.*)$)/gm,j={};return j.counters={},j.debug=function(a){e=a?function(){console.log.apply(console,[].slice.apply(arguments))}:function(){}},j.debug(!1),j.method="window.runnerWindow.protect",j.rewriteLoops=function(a,e){var g=[],i=a.split("\n"),k=!1,l=j.method,m={},n={},o=null,p=function(a,b,c){return b.slice(0,c)+";"+l+"({ line: "+a+", reset: true }); "+b.slice(c)};return e||(e=0),i.forEach(function(a,j){if(f.lastIndex=0,h.lastIndex=0,!k){-1!==a.toLowerCase().indexOf("noprotect")&&(k=!0);var q=-1,r=-1,s=j,t=j-e+1,u="",v=!1,w=!1,x=!1,y=a.match(f)||[],z=y.length?y[0]:"",A=a.match(h)||[],B=0,C=0;if(A.length&&(q=a.indexOf(A[1]),c(q,a)||b(j,i)||d(q,j,i)&&(o=j)),!m[j]){if(n[j])return void g.push(a);if(z&&1===y.length&&-1===a.indexOf("jsbin")){if(v="do"===z,r=q=a.indexOf(z),c(q,a))return void g.push(a);if(b(j,i))return void g.push(a);for(q=a.indexOf(z)+z.length,q===a.length&&q===a.length&&j<i.length-1&&(g.push(a),j++,a=i[j],m[j]=!0,q=0);q<a.length;){if(u=a.substr(q,1),"("===u&&B++,")"===u&&(B--,0===B&&x===!1&&(x=q)),"{"===u&&C++,"}"===u&&C--,0===B&&(";"===u||"{"===u)){if(";"===u)j!==s?(g[s]=g[s].substring(0,x+1)+"{\nif ("+l+"({ line: "+t+" })) break;\n"+g[s].substring(x+1),a+="\n}\n"):a=a.substring(0,x+1)+"{\nif ("+l+"({ line: "+t+" })) break;\n"+a.substring(x+1)+"\n}\n";else if("{"===u){var D=";\nif ("+l+"({ line: "+t+" })) break;\n";a=a.substring(0,q+1)+D+a.substring(q+1),q+=D.length}if(j===s&&null===o?(a=p(t,a,r),q+=(";"+l+"({ line: "+j+", reset: true }); ").length):null===o?g[s]=p(t,g[s],r):(void 0===g[o]&&(o--,r=0),g[o]=p(t,g[o],r),o=null),g.push(a),v){for(w=!1;q<a.length;){if(u=a.substr(q,1),"{"===u&&C++,"}"===u&&C--,w=0===C?!0:!1,w&&-1!==a.indexOf("while"))return void(n[j]=!0);q++,q===a.length&&j<i.length-1&&(j++,a=i[j],q=0)}return}return}q++,q===a.length&&j<i.length-1&&(g.push(a),j++,a=i[j],m[j]=!0,q=0)}}else g.push(a)}}}),k?a:g.join("\n")},j.protect=function(a){j.counters[a.line]=j.counters[a.line]||{};var b=j.counters[a.line],c=(new Date).getTime();return a.reset&&(b.time=c,b.hit=0,b.last=0),b.hit++,c-b.time>100?(j.hit(),!0):(b.last++,!1)},j.hit=function(b){var c="Exiting potential infinite loop at line "+b+'. To disable loop protection: add "// noprotect" to your code';a.proxyConsole?a.proxyConsole.error(c):console.error(c)},j.reset=function(){j.counters={}},j});